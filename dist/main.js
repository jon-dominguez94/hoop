/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/ios-inner-height/dist/ios-inner-height.js":
/*!****************************************************************!*\
  !*** ./node_modules/ios-inner-height/dist/ios-inner-height.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var require;var require;(function(f){if(true){module.exports=f()}else { var g; }})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return require(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\n/**\n * @module ios-inner-height\n *\n * @description Get proper window.innerHeight from iOS devices,\n * excluding URL control and menu bar.\n *\n * @return {function} Callable function to retrieve the\n * cached `window.innerHeight` measurement, specific to the\n * device's current orientation.\n */\nmodule.exports = (function () {\n\t// Non-iOS browsers return window.innerHeight per usual.\n\t// No caching here since browsers can be resized, and setting\n\t// up resize-triggered cache invalidation is not in scope.\n\t/* istanbul ignore if  */\n\tif (!navigator.userAgent.match(/iphone|ipod|ipad/i)) {\n\t\t/**\n\t\t * Avoids conditional logic in the implementation\n\t\t * @return {number} - window's innerHeight measurement in pixels\n\t\t */\n\t\treturn function () {\n\t\t\treturn window.innerHeight;\n\t\t};\n\t}\n\n\t// Store initial orientation\n\tvar axis = Math.abs(window.orientation);\n\t// And hoist cached dimensions\n\tvar dims = {w: 0, h: 0};\n\n\t/**\n\t * Creates an element with a height of 100vh since iOS accurately\n\t * reports vp height (but not window.innerHeight). Then destroy it.\n\t */\n\tvar createRuler = function () {\n\t\tvar ruler = document.createElement('div');\n\n\t\truler.style.position = 'fixed';\n\t\truler.style.height = '100vh';\n\t\truler.style.width = 0;\n\t\truler.style.top = 0;\n\n\t\tdocument.documentElement.appendChild(ruler);\n\n\t\t// Set cache conscientious of device orientation\n\t\tdims.w = axis === 90 ? ruler.offsetHeight : window.innerWidth;\n\t\tdims.h = axis === 90 ? window.innerWidth : ruler.offsetHeight;\n\n\t\t// Clean up after ourselves\n\t\tdocument.documentElement.removeChild(ruler);\n\t\truler = null;\n\t};\n\n\t// Measure once\n\tcreateRuler();\n\n\t/**\n\t * Returns window's cached innerHeight measurement\n\t * based on viewport height and device orientation\n\t * @return {number} - window's innerHeight measurement in pixels\n\t */\n\treturn function () {\n\t\tif (Math.abs(window.orientation) !== 90) {\n\t\t\treturn dims.h;\n\t\t}\n\t\treturn dims.w;\n\t};\n})();\n\n},{}]},{},[1])(1)\n});\n\n\n//# sourceURL=webpack:///./node_modules/ios-inner-height/dist/ios-inner-height.js?");

/***/ }),

/***/ "./src/ancestors.js":
/*!**************************!*\
  !*** ./src/ancestors.js ***!
  \**************************/
/*! exports provided: Point, Entity, Multiplier */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Point\", function() { return Point; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Entity\", function() { return Entity; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Multiplier\", function() { return Multiplier; });\nclass Point {\n\n  constructor(x, y) {\n    this.x = x || 0;\n    this.y = y || 0;\n  }\n\n  distanceTo(p) {\n    var dx = p.x - this.x;\n    var dy = p.y - this.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  clonePosition() {\n    return { x: this.x, y: this.y };\n  }\n\n  interpolate(x, y, amp) {\n    this.x += (x - this.x) * amp;\n    this.y += (y - this.y) * amp;\n  }\n}\n\nclass Entity extends Point{\n  constructor(x, y){\n    super(x, y);\n    this.alive = false;\n  }\n}\n\nclass Multiplier {\n  constructor(step, max){\n    this.major = 1;\n    this.minor = 0;\n\n    this.max = max;\n    this.step = step;\n  }\n\n  reset(){\n    this.major = 1;\n    this.minor = 0;\n  }\n\n  increase() {\n    this.minor += this.step;\n\n    while (this.minor >= 1) {\n      if (this.major < this.max) {\n        this.major++;\n      }\n\n      this.minor = 1 - this.minor;\n    }\n  }\n}\n\n//# sourceURL=webpack:///./src/ancestors.js?");

/***/ }),

/***/ "./src/constants.js":
/*!**************************!*\
  !*** ./src/constants.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nconst constants = {\n  FRAMERATE: 60,\n  DEFAULT_HEIGHT: 510,\n  DEFAULT_WIDTH: 900,\n  TOUCH_INPUT: navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/i),\n\n  ENEMY_COUNT: 2,\n  ENEMY_SIZE: 10,\n  ENEMY_TYPE_NORMAL: 1,\n  ENEMY_TYPE_BOMB: 2,\n\n  SCORE_PER_ENEMY: 50,\n  SCORE_PER_TICK: 0.2,\n  ENERGY_PER_ENEMY_DEATH: -20,\n  ENERGY_PER_ENEMY_ENCLOSED: 1,\n  ENERGY_PER_BOMB_ENCLOSED: -30,\n  MULTIPLIER_LIMIT: 6,\n\n  HEADER_HEIGHT: 30\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (constants);\n\n//# sourceURL=webpack:///./src/constants.js?");

/***/ }),

/***/ "./src/entities/enemy.js":
/*!*******************************!*\
  !*** ./src/entities/enemy.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ancestors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ancestors */ \"./src/ancestors.js\");\n\n\nclass Enemy extends _ancestors__WEBPACK_IMPORTED_MODULE_0__[\"Entity\"]{\n  constructor(){\n    super();\n    this.scale = 0.01;\n    this.scaleTarget = 1;\n\n    this.alpha = 0;\n    this.alphaTarget = 1;\n\n    this.time = 0;\n    this.type = 1;\n    \n    this.alive = true;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Enemy);\n\n//# sourceURL=webpack:///./src/entities/enemy.js?");

/***/ }),

/***/ "./src/entities/notification.js":
/*!**************************************!*\
  !*** ./src/entities/notification.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ancestors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ancestors */ \"./src/ancestors.js\");\n\n\nclass Notification extends _ancestors__WEBPACK_IMPORTED_MODULE_0__[\"Entity\"] {\n  constructor(text, x, y, scale, rgb) {\n    super();\n    this.text = text || '';\n    this.x = x || 0;\n    this.y = y || 0;\n    this.scale = scale || 1;\n    this.rgb = rgb || [255, 255, 255];\n    this.alpha = 1;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Notification);\n\n\n//# sourceURL=webpack:///./src/entities/notification.js?");

/***/ }),

/***/ "./src/entities/particle.js":
/*!**********************************!*\
  !*** ./src/entities/particle.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ancestors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ancestors */ \"./src/ancestors.js\");\n\n\nclass Particle extends _ancestors__WEBPACK_IMPORTED_MODULE_0__[\"Entity\"] {\n  constructor(x, y, speed, color) {\n    super();\n    this.x = x;\n    this.y = y;\n\n    this.velocity = {\n      x: -speed + (Math.random() * speed * 2),\n      y: -speed + (Math.random() * speed * 2)\n    };\n\n    this.color = color;\n    this.alpha = 1;\n    this.fading = false;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Particle);\n\n//# sourceURL=webpack:///./src/entities/particle.js?");

/***/ }),

/***/ "./src/entities/player.js":
/*!********************************!*\
  !*** ./src/entities/player.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ancestors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ancestors.js */ \"./src/ancestors.js\");\n\n\nclass Player extends _ancestors_js__WEBPACK_IMPORTED_MODULE_0__[\"Entity\"] {\n  constructor(){\n    super();\n    this.trail = [];\n    this.size = 8;\n    this.length = 45;\n    this.energy = 100;\n    this.animatedEnergy = 0;\n  }\n\n  adjustEnergy(offset){\n    this.energy = Math.min(Math.max(this.energy + offset, 0), 100);\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Player);\n\n//# sourceURL=webpack:///./src/entities/player.js?");

/***/ }),

/***/ "./src/game.js":
/*!*********************!*\
  !*** ./src/game.js ***!
  \*********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ \"./src/constants.js\");\n/* harmony import */ var _ancestors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ancestors */ \"./src/ancestors.js\");\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util */ \"./src/util.js\");\n/* harmony import */ var _entities_player__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./entities/player */ \"./src/entities/player.js\");\n/* harmony import */ var _entities_enemy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./entities/enemy */ \"./src/entities/enemy.js\");\n/* harmony import */ var _entities_particle__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./entities/particle */ \"./src/entities/particle.js\");\n/* harmony import */ var _entities_notification__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./entities/notification */ \"./src/entities/notification.js\");\n/* harmony import */ var _region__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./region */ \"./src/region.js\");\n\n\n\n\n\n\n\n\n\nclass Game {\n  constructor(){\n\n    this.context;\n    this.menu = document.getElementById(\"menu\");\n    this.scorePanel = document.getElementById('score');\n    this.openSound = document.getElementById('open');\n    this.closeSound = document.getElementById('close');\n    this.killSound = document.getElementById('kill');\n    this.killbombSound = document.getElementById('killbomb');\n    this.dieSound = document.getElementById('die');\n    this.upgradeSound = document.getElementById('upgrade');\n    this.failSound = document.getElementById('fail');\n\n    this.mouse = {\n      x: 0,\n      y: 0,\n      previousX: 0,\n      previousY: 0,\n      velocityX: 0,\n      velocityY: 0\n    };\n\n    this.world = {\n      width: _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].DEFAULT_WIDTH,\n      height: _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].DEFAULT_HEIGHT\n    };\n\n    this.sprites = {\n      bomb: null,\n      enemy: null,\n      enemyDyingA: null,\n      enemyDyingB: null\n    };\n\n    this.dirtyRegions = [],\n\n    this.playing = false,\n    this.score = 0,\n    this.duration = 0,\n    this.difficulty = 1,\n    this.multiplier = new _ancestors__WEBPACK_IMPORTED_MODULE_1__[\"Multiplier\"](0.2, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].MULTIPLIER_LIMIT);\n\n    this.frameScore = 0,\n    this.frameCount = 0,\n    this.timeStart = Date.now(),\n    this.timeLastFrame = Date.now(),\n    this.timeLastSecond = Date.now(),\n    this.timeGameStart = Date.now(),\n    this.timeDelta = 0,\n    this.timeFactor = 0,\n    this.fps = 0,\n    this.fpsMin = 1000,\n    this.fpsMax = 0,\n    this.framesThisSecond = 0;\n\n    this.notifications = [],\n    this.intersections = [],\n    this.particles = [],\n    this.enemies = [],\n    this.player = new _entities_player__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\n  }\n\n  createSprites() {\n    const canvasWidth = 64, canvasHeight = 64;\n    let cvs, ctx;\n\n    cvs = document.createElement('canvas');\n    cvs.setAttribute('width', canvasWidth);\n    cvs.setAttribute('height', canvasHeight);\n    ctx = cvs.getContext('2d');\n    ctx.beginPath();\n    ctx.arc(canvasWidth * 0.5, canvasHeight * 0.5, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE, 0, Math.PI * 2, true);\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = 'rgba(255,255,255,0.4)';\n    ctx.fillStyle = \"rgba(30,144,255,0.9)\";\n    ctx.shadowColor = 'rgba(60,174,255,0.9)';\n    // ctx.fillStyle = 'rgba(0,200,220, 0.9)';\n    // ctx.shadowColor = 'rgba(0,240,255,0.9)';\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    ctx.shadowBlur = 20;\n    ctx.stroke();\n    ctx.fill();\n\n    this.sprites.enemy = cvs;\n\n    cvs = document.createElement('canvas');\n    cvs.setAttribute('width', canvasWidth);\n    cvs.setAttribute('height', canvasHeight);\n    ctx = cvs.getContext('2d');\n    ctx.beginPath();\n    ctx.arc(canvasWidth * 0.5, canvasHeight * 0.5, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE * 1.4, 0, Math.PI * 2, true);\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = 'rgba(255,255,255,0.4)';\n    ctx.fillStyle = \"rgba(216,191,216, 0.9)\";\n    ctx.shadowColor = 'rgba(255,231,255,0.9)';\n    // ctx.fillStyle = 'rgba(190,220,90, 0.9)';\n    // ctx.shadowColor = 'rgba(220,240,150,0.9)';\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    ctx.shadowBlur = 20;\n    ctx.stroke();\n    ctx.fill();\n    \n    this.sprites.enemyDyingA = cvs;\n    \n    cvs = document.createElement('canvas');\n    cvs.setAttribute('width', canvasWidth);\n    cvs.setAttribute('height', canvasHeight);\n    ctx = cvs.getContext('2d');\n    ctx.beginPath();\n    ctx.arc(canvasWidth * 0.5, canvasHeight * 0.5, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE * 1.4, 0, Math.PI * 2, true);\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = 'rgba(255,255,255,0.4)';\n    ctx.fillStyle = \"rgba(216,191,216, 0.9)\";\n    ctx.shadowColor = 'rgba(255,231,255,0.9)';\n    // ctx.fillStyle = 'rgba(190,220,90, 0.9)';\n    // ctx.shadowColor = 'rgba(220,240,150,0.9)';\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    ctx.shadowBlur = 10;\n    ctx.stroke();\n    ctx.fill();\n\n    this.sprites.enemyDyingB = cvs;\n\n    cvs = document.createElement('canvas');\n    cvs.setAttribute('width', canvasWidth);\n    cvs.setAttribute('height', canvasHeight);\n    ctx = cvs.getContext('2d');\n    ctx.beginPath();\n    ctx.arc(canvasWidth * 0.5, canvasHeight * 0.5, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE, 0, Math.PI * 2, true);\n    ctx.lineWidth = 2;\n    ctx.fillStyle = 'rgba(220,50,50, 0.9)';\n    ctx.strokeStyle = 'rgba(255,255,255,0.4)'\n    ctx.shadowColor = \"rgba(255,100,100,0.9)\";\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    ctx.shadowBlur = 10;\n    ctx.stroke();\n    ctx.fill();\n\n    this.sprites.bomb = cvs;\n  }\n\n  reset() {\n    this.player = new _entities_player__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\n    this.player.x = this.mouse.x;\n    this.player.y = this.mouse.y;\n\n    this.notifications = [];\n    this.intersections = [];\n    this.particles = [];\n    this.enemies = [];\n\n    this.score = 0;\n    this.duration = 0;\n    this.playing = false;\n    this.difficulty = 1;\n\n    this.multiplier.reset();\n\n    this.frameCount = 0;\n    this.frameScore = 0;\n\n    this.timeStart = 0;\n    this.timeLastFrame = 0;\n  }\n  \n  update(){\n    this.clear();\n\n    if (this.playing) {\n      this.context.save();\n      this.context.globalCompositeOperation = 'lighter';\n\n      this.updateMeta();\n      this.updatePlayer();\n      this.updateParticles();\n\n      this.findIntersections();\n      this.solveIntersections();\n\n      this.renderPlayer();\n\n      this.updateEnemies();\n      this.renderEnemies();\n      this.renderParticles();\n\n      this.context.restore();\n\n      this.renderNotifications();\n    }\n\n    if (this.score !== 0) {\n      this.renderHeader();\n    }\n   \n    Object(_util__WEBPACK_IMPORTED_MODULE_2__[\"requestAnimFrame\"])(this.update.bind(this));\n  }\n\n  clear() {\n    for (let i = this.dirtyRegions.length - 1; i >= 0; i--){\n      var dirtyRegion = this.dirtyRegions[i];\n      this.context.clearRect(Math.floor(dirtyRegion.x), Math.floor(dirtyRegion.y), Math.ceil(dirtyRegion.width), Math.ceil(dirtyRegion.height));\n    }\n\n    this.dirtyRegions = [];\n  }\n\n  start() {\n    this.reset();\n\n    this.openSound.currentTime = 0;\n    this.openSound.play();\n\n    this.timeStart = Date.now();\n    this.timeLastFrame = this.timeStart;\n\n    this.playing = true;\n\n    const ih = document.getElementById('initial-header');\n    if(ih) ih.remove();\n    document.getElementById('score').classList.add('hidden');\n    this.menu.classList.add('fade-out');\n    setTimeout(() => {\n      this.menu.classList.add('behind');\n    }, 700);\n  }\n    \n  stop() {\n    this.closeSound.currentTime = 0;\n    this.closeSound.play();\n\n    this.scorePanel.style.display = 'block';\n    document.getElementById('score-p').innerHTML = Math.floor(this.score);\n    \n    this.playing = false;\n\n    this.menu.classList.remove('behind');\n    this.menu.classList.remove('fade-out');\n    document.getElementById('score').classList.remove('hidden');\n}\n\n  invalidate(x, y, width, height) {\n    this.dirtyRegions.push({\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    });\n  }\n\n  updatePlayer() {\n    this.player.interpolate(this.mouse.x, this.mouse.y, 0.4);\n\n    while (this.player.trail.length < this.player.length) {\n      this.player.trail.push(new _ancestors__WEBPACK_IMPORTED_MODULE_1__[\"Point\"](this.player.x, this.player.y));\n    }\n\n    this.player.trail.shift();\n    if (this.player.energy === 0) {\n      this.stop();\n    }\n  }\n\n  renderPlayer() {\n    this.context.beginPath();\n    const bounds = new _region__WEBPACK_IMPORTED_MODULE_7__[\"default\"]();\n\n    for (let i = 0; i < this.player.trail.length; i++) {\n      const p1 = this.player.trail[i];\n      const p2 = this.player.trail[i + 1];\n\n      if (i === 0) {\n        this.context.moveTo(p1.x + (p2.x - p1.x) / 2, p1.y + (p2.y - p1.y) / 2);\n      }\n      else if (p2) {\n        this.context.quadraticCurveTo(p1.x, p1.y, p1.x + (p2.x - p1.x) / 2, p1.y + (p2.y - p1.y) / 2);\n      }\n\n      bounds.inflate(p1.x, p1.y);\n    }\n    this.context.strokeStyle = \"#BA55D3\";\n    // this.context.strokeStyle = \"#8A2BE2\";\n    // this.context.strokeStyle = \"#FB7200\";\n    this.context.lineWidth = 2;\n    this.context.stroke();\n\n    bounds.expand(4, 4);\n\n    const boundsRect = bounds.toRectangle();\n\n    this.invalidate(boundsRect.x, boundsRect.y, boundsRect.width, boundsRect.height);\n  }\n\n  adjustScore(offset) {\n    let multipliedOffset = 0;\n\n    if (this.playing) {\n      multipliedOffset = offset * this.multiplier.major;\n      this.score += multipliedOffset * (this.fps / _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].FRAMERATE);\n    }\n\n    return multipliedOffset;\n  }\n\n  updateMeta() {\n  // Fetch the current time for this frame\n    const timeThisFrame = Date.now();\n\n    // Increase the frame count\n    this.framesThisSecond++;\n\n    // Check if a second has passed since the last time we updated the FPS\n    if (timeThisFrame > this.timeLastSecond + 1000) {\n      // Establish the current, minimum and maximum FPS\n      this.fps = Math.min(Math.round((this.framesThisSecond * 1000) / (timeThisFrame - this.timeLastSecond)), _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].FRAMERATE);\n      this.fpsMin = Math.min(this.fpsMin, this.fps);\n      this.fpsMax = Math.max(this.fpsMax, this.fps);\n\n      this.timeLastSecond = timeThisFrame;\n      this.framesThisSecond = 0;\n    }\n\n    this.timeDelta = timeThisFrame - this.timeLastFrame;\n    this.timeFactor = this.timeDelta / (1000 / _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].FRAMERATE);\n\n    // Increment the difficulty by a factor of the time\n    // passed since the last rendered frame to ensure that\n    // difficulty progresses at the same speed no matter what\n    // FPS the game runs at\n    this.difficulty += 0.002 * Math.max(this.timeFactor, 1);\n    this.adjustScore(1);\n\n    this.frameCount++;\n    this.frameScore++;\n\n    this.duration = timeThisFrame - this.timeStart;\n\n    this.timeLastFrame = timeThisFrame;\n\n  }\n\n  renderHeader() {\n\n    const padding = 10,\n      energyBarHeight = 4,\n      energyBarWidth = 100,\n      ENERGY_LABEL = 'ENERGY:',\n      MULTIPLIER_LABEL = 'MULTIPLIER:',\n      TIME_LABEL = 'TIME:',\n      SCORE_LABEL = 'SCORE:';\n\n    this.player.animatedEnergy += (this.player.energy - this.player.animatedEnergy) * 0.2;\n\n    this.context.fillStyle = 'rgba(0,0,0,0.5)';\n    this.context.fillRect(0, 0, this.world.width, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].HEADER_HEIGHT);\n\n    this.context.save();\n    this.context.translate(padding, padding);\n\n    // Energy label\n    this.context.fillStyle = \"#ffffff\";\n    this.context.font = \"11px Arial\";\n    this.context.fillText(ENERGY_LABEL, 0, 8);\n    this.context.translate(56, 0);\n\n    // Energy bar \n    this.context.save();\n    this.context.fillStyle = 'rgba(40,40,40,0.8)';\n    this.context.fillRect(0, 2, energyBarWidth, energyBarHeight);\n    this.context.shadowOffsetX = 0;\n    this.context.shadowOffsetY = 0;\n    this.context.shadowBlur = 14;\n    this.context.shadowColor = \"rgba(255,0,255, 0.9)\";\n    this.context.fillStyle = \"rgba(255,0,255, 0.8)\";\n    // this.context.shadowColor = \"rgba(178,73,255,0.9)\";\n    // this.context.fillStyle = \"rgba(138,43,226, 0.8)\";\n    // this.context.shadowColor = \"rgba(255,150,0,0.9)\";\n    // this.context.fillStyle = 'rgba(251,114,0, 0.8)';\n    // this.context.shadowColor = \"rgba(0,240,255,0.9)\";\n    // this.context.fillStyle = 'rgba(0,200,220, 0.8)';\n    this.context.fillRect(0, 2, (this.player.animatedEnergy / 100) * energyBarWidth, energyBarHeight);\n    this.context.restore();\n\n    this.context.translate(122, 0);\n\n    // Time label\n    this.context.font = \"11px Arial\";\n    this.context.fillStyle = \"#ffffff\";\n    this.context.fillText(TIME_LABEL, 0, 8);\n\n    // Time\n    this.context.font = \"bold 11px Arial\";\n    this.context.fillStyle = \"rgb(255,0,255)\";\n    // this.context.fillStyle = \"rgb(138,43,226)\";\n    // this.context.fillStyle = \"rgba(251,114,0, 0.8)\";\n    this.context.fillText(Math.round(this.duration / 1000) + 's', 35, 8);\n\n    this.context.translate(70, 0);\n\n    // Score label\n    this.context.font = \"11px Arial\";\n    this.context.fillStyle = \"#ffffff\";\n    this.context.fillText(SCORE_LABEL, 0, 8);\n\n    // Score\n    this.context.font = \"bold 11px Arial\";\n    this.context.fillStyle = \"rgb(255,0,255)\";\n    // this.context.fillStyle = \"rgb(138,43,226)\";\n    // this.context.fillStyle = \"rgba(251,114,0, 0.8)\";\n    this.context.fillText(Math.floor(this.score), 47, 8);\n    \n    this.context.translate(90, 0);\n    \n    // Multiplier label\n    this.context.font = \"11px Arial\";\n    this.context.fillStyle = \"#ffffff\";\n    this.context.fillText(MULTIPLIER_LABEL, 0, 8);\n    this.context.translate(73, 0);\n\n    // Multiplier\n    for (let i = _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].MULTIPLIER_LIMIT - 1; i >= 0; i--){\n      this.context.save();\n      this.context.beginPath();\n\n      const x = 6 + (i / _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].MULTIPLIER_LIMIT) * 80;\n      const y = 5;\n      const radius = 6;\n\n      this.context.fillStyle = 'rgba(40,40,40,0.8)';\n      this.context.arc(x, y, radius, 0, Math.PI * 2, true);\n      this.context.fill();\n\n      if (i < this.multiplier.major) {\n        this.context.beginPath();\n        this.context.shadowOffsetX = 0;\n        this.context.shadowOffsetY = 0;\n        this.context.shadowBlur = 14;\n        // this.context.shadowColor = \"rgba(0,240,255,0.9)\";\n        // this.context.fillStyle = 'rgba(0,200,220,0.8)';\n        // this.context.shadowColor = \"rgba(255,150,0,0.9)\";\n        // this.context.fillStyle = 'rgba(251,114,0, 0.8)';\n        this.context.shadowColor = \"rgba(255,0,255, 0.9)\";\n        this.context.fillStyle = \"rgba(255,0,255, 0.9)\";\n        // this.context.shadowColor = \"rgba(178,73,255,0.9)\";\n        // this.context.fillStyle = \"rgba(138,43,226, 0.8)\";\n\n        if (i < this.multiplier.major - 1) {\n          // We're drawing a major (entirely filled) step\n          this.context.arc(x, y, radius, 0, Math.PI * 2, true);\n        }\n        else {\n          // We're drawing a minor (partly filled) step\n          this.context.fillStyle = \"rgba(255,0,255,\" + 0.8 * this.multiplier.minor + \")\";\n          // this.context.fillStyle = \"rgba(138,43,226,\" + 0.8 * this.multiplier.minor + \")\";\n          // this.context.fillStyle = \"rgba(251,114,0,\" + 0.8 * this.multiplier.minor + \")\";\n          // this.context.fillStyle = 'rgba(0,200,220,' + (0.8 * this.multiplier.minor) + ')';\n          this.context.arc(x, y, radius * this.multiplier.minor, 0, Math.PI * 2, false);\n        }\n\n        this.context.fill();\n      }\n\n      this.context.restore();\n    }\n\n    this.context.restore();\n\n    this.invalidate(0, 0, this.world.width, _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].HEADER_HEIGHT + 5);\n  }\n\n  findIntersections() {\n    const candidates = [];\n    for (let i = this.player.trail.length; i > 0; i--){\n      \n      const p1 = this.player.trail[i];\n      const p2 = this.player.trail[i + 1];\n      \n      for (let j = this.player.trail.length; j > 0; j--){\n\n        if (Math.abs(i - j) > 1) {\n          const p3 = this.player.trail[j];\n          const p4 = this.player.trail[j + 1];\n\n          if (p1 && p2 && p3 && p4) {\n            const intersection = this.findLineIntersection(p1, p2, p3, p4);\n            if (intersection) {\n              candidates.push([Math.min(i, j), Math.max(i, j), intersection]);\n            }\n          }\n        }\n\n      }\n    }\n\n    this.intersections = [];\n\n    // Remove duplicates\n    while (candidates.length) {\n      let candidate = candidates.pop();\n      for (let i = this.intersections.length; i > 0; i--){\n        if (candidate && this.intersections[i] && candidate[0] === this.intersections[i][0] && candidate[1] === this.intersections[i][1]) {\n          candidate = null;\n        }\n      }\n      if (candidate) {\n        this.intersections.push(candidate);\n      }\n    }\n\n    // if(this.intersections.length) console.log(this.intersections);\n  }\n\n  findLineIntersection(p1, p2, p3, p4) {\n    const delta1 = {\n      x: p2.x - p1.x,\n      y: p2.y - p1.y\n    };\n\n    const delta2 = {\n      x: p4.x - p3.x,\n      y: p4.y - p3.y\n    };\n\n    const diff1 = (-delta1.y * (p1.x - p3.x) + delta1.x * (p1.y - p3.y)) / (-delta2.x * delta1.y + delta1.x * delta2.y);\n    const diff2 = (delta2.x * (p1.y - p3.y) - delta2.y * (p1.x - p3.x)) / (-delta2.x * delta1.y + delta1.x * delta2.y);\n\n    if (diff1 >= 0 && diff1 <= 1 && diff2 >= 0 && diff2 <= 1) {\n      return {\n        x: p1.x + (diff2 * delta1.x),\n        y: p1.y + (diff2 * delta1.y)\n      };\n    }\n\n    return null;\n  }\n\n  solveIntersections() {\n\n    while (this.intersections.length) {\n      const last_intersection = this.intersections.pop();\n      this.context.beginPath();\n      const points = this.player.trail.slice(last_intersection[0], last_intersection[1]);\n\n      points[0] = last_intersection[2];\n      points.push(last_intersection[2]);\n\n      const bounds = new _region__WEBPACK_IMPORTED_MODULE_7__[\"default\"]();\n\n      for (let i = 0, len = points.length; i < len; i++) {\n        const p1 = points[i];\n        const p2 = points[i + 1];\n\n        if (i === 0) {\n          // First loop, only move into position\n          this.context.moveTo(p1.x, p1.y);\n        }\n        else if (p1 && p2) {\n          // Draw a curve between the current and next trail point\n          this.context.quadraticCurveTo(p1.x, p1.y, p1.x + (p2.x - p1.x) / 2, p1.y + (p2.y - p1.y) / 2);\n        }\n\n        bounds.inflate(p1.x, p1.y);\n      }\n\n      const center = bounds.center();\n  \n      const gradient = this.context.createRadialGradient(center.x, center.y, 0, center.x, center.y, bounds.size());\n      // gradient.addColorStop(1, 'rgba(0, 255, 255, 0.0)');\n      // gradient.addColorStop(0, 'rgba(0, 255, 255, 0.2)');\n      gradient.addColorStop(1, \"rgba(255,0,255, 0.0)\");\n      gradient.addColorStop(0, \"rgba(255,0,255, 0.2)\");\n      // gradient.addColorStop(1, \"rgba(138,43,226, 0.0)\");\n      // gradient.addColorStop(0, \"rgba(138,43,226, 0.2)\");\n      // gradient.addColorStop(1, \"rgba(255, 150, 0, 0.0)\");\n      // gradient.addColorStop(0, \"rgba(255, 150, 0, 0.2)\");\n      this.context.fillStyle = gradient;\n      this.context.closePath();\n\n      this.context.fill();\n    }\n\n    if (this.frameCount % 2 == 1) {\n\n      const bmp = this.context.getImageData(0, 0, this.world.width, this.world.height);\n      const bmpw = bmp.width;\n      const pixels = bmp.data;\n      const casualties = [];\n\n      for(let i = this.enemies.length - 1; i >= 0; i--){\n        const enemy = this.enemies[i];\n\n        const ex = Math.round(enemy.x);\n        const ey = Math.round(enemy.y);\n\n        const indices = [\n          ((ey * bmpw) + Math.round(ex - _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE)) * 4,\n          ((ey * bmpw) + Math.round(ex + _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE)) * 4,\n          ((Math.round(ey - _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE) * bmpw) + ex) * 4,\n          ((Math.round(ey + _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_SIZE) * bmpw) + ex) * 4\n        ];\n\n        for(let j = indices.length; j >= 0; j--){\n          const index = indices[j];\n          // console.log(`first: ${pixels[index + 1]}`);\n          // console.log(`second: ${pixels[index + 2]}`);\n          // if (pixels[index + 1] > 0 && pixels[index + 2] === 0) {\n          if (pixels[index + 1] === 0 && pixels[index + 2] > 0) {\n\n            if (enemy.type === _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB || enemy.type === _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB_MOVER) {\n              this.handleBombInClosure(enemy);\n            }\n            else {\n              this.handleEnemyInClosure(enemy);\n\n              casualties.push(enemy);\n            }\n\n            this.enemies.splice(i, 1);\n\n            break;\n          }\n        }\n      }\n\n      // If more than one enemy was killed, show the total score\n      if (casualties.length > 1) {\n  \n        const scoreChange = this.adjustScore(casualties.length * _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].SCORE_PER_ENEMY);\n\n        this.notify(scoreChange, this.player.x, this.player.y - 10, casualties.length / 1.5, [250, 250, 100]);\n      }\n\n    }\n  }\n\n  updateEnemies() {\n\n    let enemy;\n    const padding = 60;\n    let numberOfBombs = 0;\n\n    for(let i = this.enemies.length - 1; i >= 0; i--){\n      if (this.enemies[i].type === _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB) {\n        numberOfBombs++;\n      }\n    }\n\n    const canAddBombs = numberOfBombs / this.enemies.length < 0.4;\n    let missingEnemies = Math.floor(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_COUNT + this.difficulty) - this.enemies.length;\n\n    while (missingEnemies-- && Math.random() > 0.85) {\n\n      let type = _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_NORMAL;\n\n      if (canAddBombs) {\n        type = Math.random() > 0.5 ? type : _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB;\n      }\n\n      enemy = new _entities_enemy__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\n      enemy.x = padding + Math.round(Math.random() * (this.world.width - padding - padding));\n      enemy.y = padding + Math.round(Math.random() * (this.world.height - padding - padding));\n      enemy.type = type;\n\n      this.enemies.push(enemy);\n    }\n\n    for (let i = this.enemies.length - 1; i >= 0; i--) {\n      enemy = this.enemies[i];\n      enemy.time = Math.min(enemy.time + (0.2 * this.timeFactor), 100);\n      enemy.scale += ((enemy.scaleTarget - enemy.scale) + 0.01) * 0.3;\n      enemy.alpha += (enemy.alphaTarget - enemy.alpha) * 0.1;\n\n      if (enemy.alive && enemy.time === 100) {\n        if (enemy.type === _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB) {\n          this.handleBombDeath(enemy);\n        }\n        else {\n          this.handleEnemyDeath(enemy);\n          this.enemies.splice(i, 1);\n        }\n        enemy.alive = false;\n      }\n\n      if (enemy.alive === false && enemy.alphaTarget === 0 && enemy.alpha < 0.05) {\n        this.enemies.splice(i, 1);\n      }\n    }\n\n  }\n\n  renderEnemies() {\n    for (let i = this.enemies.length - 1; i >= 0; i--) {\n      const enemy = this.enemies[i];\n\n      let sprite = null;\n\n      if (enemy.type === _constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENEMY_TYPE_BOMB) {\n        sprite = this.sprites.bomb;\n      } else {\n        sprite = this.sprites.enemy;\n\n        if (enemy.time > 65) {\n          sprite = this.sprites.enemyDyingA;\n          if (Math.round(enemy.time) % 2 === 0) {\n            sprite = this.sprites.enemyDyingB;\n          }\n        }\n      }\n\n      this.context.save();\n      this.context.globalAlpha = enemy.alpha;\n\n      this.context.translate(Math.round(enemy.x), Math.round(enemy.y));\n      this.context.scale(enemy.scale, enemy.scale);\n      this.context.drawImage(sprite, -Math.round(sprite.width / 2), -Math.round(sprite.height / 2));\n\n      this.context.restore();\n\n      const spriteWidth = sprite.width * enemy.scale + 4;\n      const spriteHeight = sprite.height * enemy.scale + 4;\n\n      this.invalidate(enemy.x - spriteWidth / 2, enemy.y - spriteWidth / 2, spriteWidth, spriteHeight);\n    }\n  }\n\n  handleBombDeath(entity) {\n    entity.alphaTarget = 0;\n    entity.scaleTarget = 0.01;\n  }\n\n  handleEnemyDeath(entity) {\n    this.dieSound.currentTime = 0;\n    this.dieSound.play();\n\n    this.player.adjustEnergy(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENERGY_PER_ENEMY_DEATH);\n    this.multiplier.reset();\n    this.failSound.currentTime = 0;\n    this.failSound.play();\n\n    this.emitParticles('#eeeeee', entity.x, entity.y, 3, 15);\n\n    this.notify(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENERGY_PER_ENEMY_DEATH + '♥', entity.x, entity.y, 1.2, [230, 90, 90]);\n  }\n\n  emitParticles(color, x, y, speed, quantity) {\n    while (quantity--) {\n      this.particles.push(new _entities_particle__WEBPACK_IMPORTED_MODULE_5__[\"default\"](x, y, speed, color));\n    }\n  }\n\n  updateParticles() {\n\n    for(let i = this.particles.length - 1; i >= 0; i--){\n      const particle = this.particles[i];\n\n      particle.x += particle.velocity.x;\n      particle.y += particle.velocity.y;\n\n      particle.velocity.x *= 0.98;\n      particle.velocity.y *= 0.98;\n\n      if (particle.fading === true) {\n        particle.alpha *= 0.92;\n      }\n      else if (Math.random() > 0.92) {\n        particle.fading = true;\n      }\n\n      if (particle.alpha < 0.05) {\n        this.particles.splice(i, 1);\n      }\n    }\n\n  }\n\n  renderParticles() {\n    for (let i = this.particles.length - 1; i >= 0; i--) {\n      const particle = this.particles[i];\n\n      this.context.save();\n      this.context.globalAlpha = particle.alpha;\n      this.context.fillStyle = particle.color;\n      this.context.fillRect(particle.x, particle.y, 3, 3);\n      this.context.restore();\n\n      this.invalidate(particle.x - 2, particle.y - 2, 6, 6);\n    }\n  }\n\n  notify(text, x, y, scale, rgb) {\n    this.notifications.push(new _entities_notification__WEBPACK_IMPORTED_MODULE_6__[\"default\"](text, x, y, scale, rgb));\n  }\n\n  renderNotifications() {\n    for(let i = this.notifications.length - 1; i >= 0; i--){\n      const notification = this.notifications[i];\n\n      // Make the text float upwards\n      notification.y -= 0.4;\n\n      let radius = 14 * notification.scale;\n\n      // Draw the notification\n      this.context.save();\n      this.context.font = 'bold ' + Math.round(12 * notification.scale) + \"px Arial\";\n\n      this.context.beginPath();\n      this.context.fillStyle = 'rgba(0,0,0,' + (0.7 * notification.alpha) + ')';\n      this.context.arc(notification.x, notification.y, radius, 0, Math.PI * 2, true);\n      this.context.fill();\n\n      this.context.fillStyle = \"rgba( \" + notification.rgb[0] + \", \" + notification.rgb[1] + \", \" + notification.rgb[2] + \", \" + notification.alpha + \" )\";\n      this.context.fillText(notification.text, notification.x - (this.context.measureText(notification.text).width * 0.5), notification.y + (4 * notification.scale));\n      this.context.restore();\n\n      // Fade out\n      notification.alpha *= 1 - (0.08 * (1 - ((notification.alpha - 0.08) / 1)));\n\n      // If the notifaction is faded out, remove it\n      if (notification.alpha < 0.05) {\n        this.notifications.splice(i, 1);\n      }\n\n      radius += 2;\n\n      this.invalidate(notification.x - radius, notification.y - radius, radius * 2, radius * 2);\n    }\n  }\n\n  handleEnemyInClosure(entity) {\n\n    this.killSound.currentTime = 0;\n    this.killSound.play();\n\n    this.player.adjustEnergy(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENERGY_PER_ENEMY_ENCLOSED);\n\n    const multMajor = this.multiplier.major;\n    this.multiplier.increase();\n\n    if (this.multiplier.major > multMajor) {\n      this.notify('X' + this.multiplier.major, this.world.width / 2, this.world.height / 2, this.multiplier.major, [60, 250, 130]);\n      this.upgradeSound.currentTime = 0;\n      this.upgradeSound.play();\n    }\n\n    this.emitParticles('#eeeeee', entity.x, entity.y, 3, 6);\n\n    const scoreChange = this.adjustScore(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].SCORE_PER_ENEMY);\n\n    this.notify('' + Math.floor(scoreChange), entity.x, entity.y);\n  }\n\n  handleBombInClosure(entity) {\n\n    this.killbombSound.currentTime = 0;\n    this.killbombSound.play();\n\n    this.player.adjustEnergy(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENERGY_PER_BOMB_ENCLOSED);\n    this.multiplier.reset();\n    this.failSound.currentTime = 0;\n    this.failSound.play();\n\n    this.notify(_constants__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ENERGY_PER_BOMB_ENCLOSED + '♥', entity.x, entity.y, 1.2, [230, 90, 90]);\n  }\n\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Game);\n\n//# sourceURL=webpack:///./src/game.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _game__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game */ \"./src/game.js\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ \"./src/constants.js\");\n/* harmony import */ var ios_inner_height__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ios-inner-height */ \"./node_modules/ios-inner-height/dist/ios-inner-height.js\");\n/* harmony import */ var ios_inner_height__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(ios_inner_height__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nlet container, game, canvas, bgm, muteButton;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  initialize();\n});\n\nconst initialize = () => {\n  container = document.getElementById('game');\n  canvas = document.getElementById('game-canvas');\n  bgm = document.getElementById('bgm');\n  muteButton = document.getElementById('mute-button');\n  const startButton = document.getElementById('start-button');\n\n  game = new _game__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n\n  if (canvas && canvas.getContext) {\n    game.context = canvas.getContext('2d');\n\n    startButton.addEventListener('click', onStartButtonClick, false);\n    muteButton.addEventListener('click', onMuteButtonClick, false);\n    document.addEventListener('mousemove', onDocumentMouseMoveHandler, false);\n    canvas.addEventListener('touchstart', onCanvasTouchStartHandler, false);\n    canvas.addEventListener('touchmove', onCanvasTouchMoveHandler, false);\n    // canvas.addEventListener('touchend', onCanvasTouchEndHandler, false);\n    window.addEventListener('resize', onWindowResizeHandler, false);\n\n    onWindowResizeHandler();\n    if(_constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].TOUCH_INPUT){\n      muteMusic();\n    }\n\n    game.createSprites();\n    game.reset();\n    game.update();\n  }\n  else {\n    alert('Your browser doesn\\'t) support HTML5 canvas');\n  }\n};\n\nconst muteMusic = () => {\n  // for(let i = 0; i < 2; i++){\n  //   muteButton.touch();\n  //   // muteButton.touchend();\n  // }\n  const audioTags = document.getElementsByTagName(\"audio\");\n  for (let i = 0; i < audioTags.length; i++) {\n    audioTags[i].muted = true;\n  }\n  muteButton.innerHTML = \"UNMUTE\";\n};\n\nconst onStartButtonClick = (event) => {\n  event.preventDefault();\n  game.start();\n};\n\nconst onMuteButtonClick = (event) => {\n  event.preventDefault();\n  const audioTags = document.getElementsByTagName('audio');\n  if(bgm.muted === true){\n    for(let i = 0; i < audioTags.length; i++) {\n      audioTags[i].muted = false;\n    }\n    muteButton.innerHTML = \"MUTE\";\n  } else {\n    for (let i = 0; i < audioTags.length; i++) {\n      audioTags[i].muted = true;\n    }\n    muteButton.innerHTML = \"UNMUTE\";\n  } \n};\n\nconst onDocumentMouseMoveHandler = (event) => {\n  game.mouse.previousX = game.mouse.x;\n  game.mouse.previousY = game.mouse.y;\n\n  game.mouse.x = event.clientX - (window.innerWidth - game.world.width) * 0.5;\n  // game.mouse.y = event.clientY - (window.innerHeight - game.world.height) * 0.5;\n  // mouse tracking fix. TODO: find real solution\n  game.mouse.y = event.clientY - (window.innerHeight - game.world.height) * 0.5 - 30;\n\n  game.mouse.velocityX = Math.abs(game.mouse.x - game.mouse.previousX) / game.world.width;\n  game.mouse.velocityY = Math.abs(game.mouse.y - game.mouse.previousY) / game.world.height;\n};\n\nconst onWindowResizeHandler = () => {\n\n  // Update the game size\n  // game.world.width = constants.TOUCH_INPUT ? window.innerWidth : constants.DEFAULT_WIDTH;\n  // game.world.height = constants.TOUCH_INPUT ? window.innerHeight : constants.DEFAULT_HEIGHT;\n  if(_constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].TOUCH_INPUT){\n    game.world.width = window.innerWidth;\n    game.world.height = ios_inner_height__WEBPACK_IMPORTED_MODULE_2___default()() - 150;\n    document.getElementById('main').style.alignItems = 'flex-start';\n    // game.world.height = window.innerHeight - 50;\n  } else {\n    game.world.width = window.innerWidth < _constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].DEFAULT_WIDTH ? window.innerWidth : _constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].DEFAULT_WIDTH;\n    game.world.height = window.innerHeight < _constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].DEFAULT_HEIGHT ? window.innerHeight : _constants__WEBPACK_IMPORTED_MODULE_1__[\"default\"].DEFAULT_HEIGHT;\n  }\n\n  container.style.width = (game.world.width);\n  container.style.height = (game.world.height);\n\n  canvas.width = game.world.width;\n  canvas.height = game.world.height;\n};\n\nconst onCanvasTouchStartHandler = (event) => {\n  if (event.touches.length == 1) {\n    event.preventDefault();\n\n    game.mouse.x = event.touches[0].pageX - (window.innerWidth - game.world.width) * 0.5;\n    game.mouse.y = event.touches[0].pageY - (ios_inner_height__WEBPACK_IMPORTED_MODULE_2___default()() - game.world.height) * 0.5;\n\n    // game.mouse.down = true;\n  }\n};\n\nconst onCanvasTouchMoveHandler = (event) => {\n  if (event.touches.length == 1) {\n    event.preventDefault();\n\n    game.mouse.x = event.touches[0].pageX - (window.innerWidth - game.world.width) * 0.5;\n    game.mouse.y = event.touches[0].pageY - (ios_inner_height__WEBPACK_IMPORTED_MODULE_2___default()() - game.world.height) * 0.5 + 20;\n    // game.mouse.y = event.touches[0].pageY;\n  }\n};\n\n// const onCanvasTouchEndHandler = (event) => {\n//   game.mouse.down = false;\n// };\n\n// document.addEventListener('ontouchmove', function(e) {\n//   e.preventDefault();\n// });\n\n//# sourceURL=webpack:///./src/index.js?");

/***/ }),

/***/ "./src/region.js":
/*!***********************!*\
  !*** ./src/region.js ***!
  \***********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ancestors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ancestors */ \"./src/ancestors.js\");\n\n\nclass Region {\n  constructor(){\n    this.left = 999999;\n    this.top = 999999;\n    this.right = 0;\n    this.bottom = 0;\n  }\n\n  reset(){\n    this.left = 999999;\n    this.top = 999999;\n    this.right = 0;\n    this.bottom = 0; \n  }\n\n  inflate(x, y){\n    this.left = Math.min(this.left, x);\n    this.top = Math.min(this.top, y);\n    this.right = Math.max(this.right, x);\n    this.bottom = Math.max(this.bottom, y);\n  }\n\n  expand(x, y){\n    this.left -= x;\n    this.top -= y;\n    this.right += x;\n    this.bottom += y;\n  }\n  \n  contains(x, y){\n    return x > this.left && x < this.right && y > this.top && y < this.bottom;\n  }\n\n  size(){\n    return ((this.right - this.left) + (this.bottom - this.top)) / 2;\n  }\n\n  center(){\n    return new _ancestors__WEBPACK_IMPORTED_MODULE_0__[\"Point\"](this.left + (this.right - this.left) / 2, this.top + (this.bottom - this.top) / 2);\n  }\n\n  toRectangle(){\n    return { x: this.left, y: this.top, width: this.right - this.left, height: this.bottom - this.top };\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Region);\n\n//# sourceURL=webpack:///./src/region.js?");

/***/ }),

/***/ "./src/util.js":
/*!*********************!*\
  !*** ./src/util.js ***!
  \*********************/
/*! exports provided: requestAnimFrame */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"requestAnimFrame\", function() { return requestAnimFrame; });\n// window.requestAnimFrame = (function () {\n//   return window.requestAnimationFrame ||\n//     window.webkitRequestAnimationFrame ||\n//     window.mozRequestAnimationFrame ||\n//     window.oRequestAnimationFrame ||\n//     window.msRequestAnimationFrame ||\n//     function (/* function */ callback, /* DOMElement */ element) {\n//       window.setTimeout(callback, 1000 / 60);\n//     };\n// })();\n\nconst requestAnimFrame = (cb) => {\n  return window.requestAnimationFrame(cb) ||\n    window.webkitRequestAnimationFrame(cb) ||\n    window.mozRequestAnimationFrame(cb) ||\n    window.oRequestAnimationFrame(cb) ||\n    window.msRequestAnimationFrame(cb) ||\n    function (cb) {\n      window.setTimeout(cb, 1000 / 60);\n    };\n};\n\n\n//# sourceURL=webpack:///./src/util.js?");

/***/ })

/******/ });